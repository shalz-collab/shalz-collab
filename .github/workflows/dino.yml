name: Generate Dino

on:
  schedule:
    - cron: "0 */12 * * *"
  workflow_dispatch:

jobs:
  generate:
    runs-on: ubuntu-latest

    permissions:
      contents: write

    steps:
      - uses: actions/checkout@v3

      - name: Create output
        run: mkdir -p output

      - name: Generate Dino SVG
        run: |
          cat > output/dino.svg << 'EOF'
          <svg xmlns="http://www.w3.org/2000/svg" width="900" height="200">
            <rect width="900" height="200" fill="#0d1117"/>

            <rect y="150" width="900" height="10" fill="#545454"/>

            <rect x="600" y="110" width="20" height="40" fill="#4CAF50">
              <animate attributeName="x" from="900" to="-40" dur="3s" repeatCount="indefinite"/>
            </rect>

            <g>
              <rect x="80" y="110" width="40" height="40" fill="#fff"/>
              <rect x="80" y="150" width="10" height="15" fill="#fff">
                <animate attributeName="y" values="150;145;150" dur="0.3s" repeatCount="indefinite"/>
              </rect>
              <rect x="110" y="150" width="10" height="15" fill="#fff">
                <animate attributeName="y" values="145;150;145" dur="0.3s" repeatCount="indefinite"/>
              </rect>
              <animateTransform attributeName="transform" type="translate"
                values="0 0; 0 -40; 0 0"
                dur="0.6s" begin="1s" repeatCount="indefinite"/>
            </g>
          </svg>
          EOF

      - name: Commit Dino SVG
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git add output/dino.svg
          git commit -m "Update Dino Animation" || true
          git push
